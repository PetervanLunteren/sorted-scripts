# Commands and steps to train a species classifier

############ Step 1: remove all containers and images via Docker Desktop

############ Step 2: pull fresh docker image
docker pull zaandahl/mewc-train:1.0

############ Step 3: setup .env file
# The format is VARIABLE=VALUE (e.g., N_SAMPLES=35000), see https://github.com/PetervanLunteren/mewc-train/blob/main/src/config.yaml for the variables
# If nothing is specified, it will take the default values. You can also leave out the --env-file argument all together.

############ Step 4: create docker container
set PARAMS=C:\Users\smart\Desktop\params.env
set DATA_DIR=C:\Peter\training-utils\current-train-set
docker run --env CUDA_VISIBLE_DEVICES=0 --gpus all --env-file "%PARAMS%" --volume "%DATA_DIR%":/data zaandahl/mewc-train:1.0

# OPTION: if you just want to train with defaults and only provide data
set DATA_DIR=C:\Peter\training-utils\current-train-set
docker run --env CUDA_VISIBLE_DEVICES=0 --gpus all --volume "%DATA_DIR%":/data zaandahl/mewc-train:1.0




############ OPTIONAL: train with adjusted python code. This is handy if you want to create a PR.
# before you can adjust the code, we'll need to copy the entire code dir from the VM container to our local machine
[[[zet de container aan via Docker Desktop]]]

set CONTAINERNAME=serene_hermann
docker exec %CONTAINERNAME% ls /
docker cp %CONTAINERNAME%:code/config.yaml C:\Users\smart\Desktop\adjusted_code
docker cp %CONTAINERNAME%:code/lib_common.py C:\Users\smart\Desktop\adjusted_code
docker cp %CONTAINERNAME%:code/lib_data.py C:\Users\smart\Desktop\adjusted_code
docker cp %CONTAINERNAME%:code/lib_model.py C:\Users\smart\Desktop\adjusted_code
docker cp %CONTAINERNAME%:code/mewc_train.py C:\Users\smart\Desktop\adjusted_code
docker cp %CONTAINERNAME%:code/requirements.txt C:\Users\smart\Desktop\adjusted_code

[[[adjust the code inside the adjuted_code dir]]]

# then we need to mount this adjusted code dir to the original code dir, so it will take out adjusted code instead
docker run --env CUDA_VISIBLE_DEVICES=0 --gpus all --env-file "C:\Users\smart\Desktop\params.env" --volume C:\Peter\training-utils\current-train-set:/data --volume C:\Users\smart\Desktop\adjusted_code:/code zaandahl/mewc-train







############### PRETRAINED MODELS ###############
MobileNet V2 is a lightweight convolutional neural network architecture designed for mobile and embedded devices. SSD MobileNet V2 320x320 provides a 
good balance between speed and accuracy, making it suitable for real-time applications on resource-constrained devices.
EfficientNet is from a family of image classification models from GoogleAI that train comparatively quickly on small amounts of data, making the most of limited datasets.

MN-V3-S  - MobileNet     - V3 small        - MobileNet is very suitable for embedded devices.
EN-B0    - EfficientNet  - B0              - EfficientNet works well with limited datasets. B0 is the smallest, and B7 is the largest
EN-V2S   - EfficientNet  - V2 small        - V2 is smaller and more accurate than EfficientNet B0-B7 -> https://production-media.paperswithcode.com/methods/Screen_Shot_2021-09-17_at_9.27.01_AM.png
EN-V2M   - EfficientNet  - V2 medium
EN-V2L   - EfficientNet  - V2 large

https://production-media.paperswithcode.com/methods/Screen_Shot_2021-09-17_at_9.27.01_AM.png
https://blog.research.google/2019/05/efficientnet-improving-accuracy-and.html#:~:text=Accuracy%20Comparison.,than%20the%20best%20existing%20CNN.


####### CONTACT DETAILS ##########
https://orcid.org/0000-0002-2491-1517
barry.brook@utas.edu.au

###### BENCHMARKS #####
Number of images in the dataset: 875000 met standaard instellingen -> poging 1 hield er mee op na de eerste fase (zonder error). Ponging twee viel de accuracy dramatisch. Lijkt erop dat ie dat niet aan kan, of de standaart instelleingen moeten anders met zo'n hoge N_SAMPLES : https://github.com/zaandahl/mewc-train/issues/2
Number of images in the dataset: 375000 met standaard instellingen -> gestart op vrijdag 17:00 :
Number of images in the dataset: 250000 met standaard instellingen -> gelukt met 96% accuracy en duurde ongeveer 24 uur denk ik : (2e poging weer accuracy ingestord
)
###### TEST RUN ######
(base) C:\Users\smart>docker run --env CUDA_VISIBLE_DEVICES=0 --gpus all --env-file "%PARAMS%" --volume "%DATA_DIR%":/data zaandahl/mewc-train
Saving class list to class_list.yaml
Dataset: Training Data
Number of images in the dataset: 250000
bird                     10000
cheetah                  10000
caracal                  10000
elephant                 10000
zebra                    10000
other                    10000
leopard                  10000
ostrich                  10000
african wild cat         10000
rhinoceros               10000
baboon                   10000
porcupine                10000
spotted hyaena           10000
kudu                     10000
giraffe                  10000
canid                    10000
brown hyaena             10000
lion                     10000
mongoose                 10000
cattle                   10000
gemsbok                  10000
hare                     10000
klipspringer+steenbok    10000
springbok                10000
hyrax                    10000
Name: Label, dtype: int64


Number of classes: 25
Dataset: Validation Data
Number of images in the dataset: 91684
cattle                   33745
elephant                 12590
giraffe                   6588
gemsbok                   5540
bird                      4736
african wild cat          3792
zebra                     3716
lion                      3470
hare                      3420
spotted hyaena            2951
ostrich                   2286
baboon                    2196
springbok                 1771
cheetah                    909
canid                      830
brown hyaena               808
other                      608
kudu                       567
rhinoceros                 331
mongoose                   238
porcupine                  205
leopard                    160
klipspringer+steenbok      158
caracal                     45
hyrax                       24
Name: Label, dtype: int64


Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/efficientnet_v2/efficientnetv2-b0_notop.h5
24274472/24274472 [==============================] - 4s 0us/step
Epoch 1/15
62500/62500 [==============================] - 1272s 20ms/step - loss: 0.1639 - accuracy: 0.7739 - val_loss: 0.1028 - val_accuracy: 0.8599
Epoch 2/15
62500/62500 [==============================] - 1533s 25ms/step - loss: 0.1215 - accuracy: 0.8253 - val_loss: 0.0944 - val_accuracy: 0.8702
Epoch 3/15
62500/62500 [==============================] - 1518s 24ms/step - loss: 0.1098 - accuracy: 0.8408 - val_loss: 0.0870 - val_accuracy: 0.8803
Epoch 4/15
62500/62500 [==============================] - 1505s 24ms/step - loss: 0.1026 - accuracy: 0.8497 - val_loss: 0.0842 - val_accuracy: 0.8829
Epoch 5/15
62500/62500 [==============================] - 1507s 24ms/step - loss: 0.0982 - accuracy: 0.8547 - val_loss: 0.0828 - val_accuracy: 0.8854
Epoch 6/15
62500/62500 [==============================] - 1504s 24ms/step - loss: 0.0945 - accuracy: 0.8607 - val_loss: 0.0810 - val_accuracy: 0.8865
Epoch 7/15
62500/62500 [==============================] - 1505s 24ms/step - loss: 0.0909 - accuracy: 0.8655 - val_loss: 0.0788 - val_accuracy: 0.8913
Epoch 8/15
62500/62500 [==============================] - 1502s 24ms/step - loss: 0.0886 - accuracy: 0.8688 - val_loss: 0.0778 - val_accuracy: 0.8922
Epoch 9/15
62500/62500 [==============================] - 1501s 24ms/step - loss: 0.0871 - accuracy: 0.8710 - val_loss: 0.0793 - val_accuracy: 0.8897
Epoch 10/15
62500/62500 [==============================] - 1500s 24ms/step - loss: 0.0855 - accuracy: 0.8726 - val_loss: 0.0737 - val_accuracy: 0.8957
Epoch 11/15
62500/62500 [==============================] - 1500s 24ms/step - loss: 0.0835 - accuracy: 0.8755 - val_loss: 0.0765 - val_accuracy: 0.8933
Epoch 12/15
62500/62500 [==============================] - 1505s 24ms/step - loss: 0.0823 - accuracy: 0.8772 - val_loss: 0.0745 - val_accuracy: 0.8960
Epoch 13/15
62500/62500 [==============================] - 1502s 24ms/step - loss: 0.0819 - accuracy: 0.8780 - val_loss: 0.0773 - val_accuracy: 0.8908
Epoch 14/15
62500/62500 [==============================] - 1507s 24ms/step - loss: 0.0805 - accuracy: 0.8807 - val_loss: 0.0739 - val_accuracy: 0.8967
Epoch 15/15
62500/62500 [==============================] - 1505s 24ms/step - loss: 0.0789 - accuracy: 0.8820 - val_loss: 0.0733 - val_accuracy: 0.8981
Total trainable base-model layers: 91
22921/22921 [==============================] - 231s 10ms/step - loss: 0.0583 - accuracy: 0.9218
Frozen model: test loss, test acc: [0.05833018571138382, 0.9218075275421143]
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 efficientnetv2-b0 (Function  (None, 1280)             5919312
 al)

 base_dropout (Dropout)      (None, 1280)              0

 compression_bottleneck (Den  (None, 256)              327936
 se)

 top_dropout (Dropout)       (None, 256)               0

 classification (Dense)      (None, 25)                6425

=================================================================
Total params: 6,253,673
Trainable params: 5,658,061
Non-trainable params: 595,612
_________________________________________________________________
100%|██████████| 50/50 [07:08<00:00,  8.56s/it]
>>>> Stage: 1/3, target_shape: 224, dropout: 0.1, magnitude: 5, batch_size: 4
>>>> This stage runs from epoch 1 to 10 out of 50 total epochs
62500/62500 [==============================] - 2262s 36ms/step - loss: 0.0655 - accuracy: 0.9033 - val_loss: 0.0494 - val_accuracy: 0.9333 - lr: 2.4950e-05
22921/22921 [==============================] - 233s 10ms/step - loss: 0.0431 - accuracy: 0.9430
New best-performing epoch of model (size = 224px) saved as: "C:\Users\smart\Desktop\mewc-output-dir"/mewc_model_224px_best.h5
Epoch 2/2
62500/62500 [==============================] - 2251s 36ms/step - loss: 0.0599 - accuracy: 0.9130 - val_loss: 0.0492 - val_accuracy: 0.9332 - lr: 5.0000e-05
22921/22921 [==============================] - 231s 10ms/step - loss: 0.0439 - accuracy: 0.9412
Epoch 3/3
62500/62500 [==============================] - 2234s 36ms/step - loss: 0.0494 - accuracy: 0.9281 - val_loss: 0.0468 - val_accuracy: 0.9373 - lr: 4.8957e-05
22921/22921 [==============================] - 232s 10ms/step - loss: 0.0408 - accuracy: 0.9463
New best-performing epoch of model (size = 224px) saved as: "C:\Users\smart\Desktop\mewc-output-dir"/mewc_model_224px_best.h5
Epoch 4/4
62500/62500 [==============================] - 2241s 36ms/step - loss: 0.0442 - accuracy: 0.9361 - val_loss: 0.0445 - val_accuracy: 0.9421 - lr: 4.7937e-05
22921/22921 [==============================] - 232s 10ms/step - loss: 0.0379 - accuracy: 0.9524
New best-performing epoch of model (size = 224px) saved as: "C:\Users\smart\Desktop\mewc-output-dir"/mewc_model_224px_best.h5
Epoch 5/5
62500/62500 [==============================] - 2236s 36ms/step - loss: 0.0423 - accuracy: 0.9407 - val_loss: 0.0620 - val_accuracy: 0.9336 - lr: 4.6937e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0579 - accuracy: 0.9430
Epoch 6/6
62500/62500 [==============================] - 2250s 36ms/step - loss: 0.1656 - accuracy: 0.9285 - val_loss: 0.0486 - val_accuracy: 0.9445 - lr: 4.5958e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0470 - accuracy: 0.9504
Epoch 7/7
62500/62500 [==============================] - 2244s 36ms/step - loss: 0.0458 - accuracy: 0.9411 - val_loss: 0.0466 - val_accuracy: 0.9409 - lr: 4.5000e-05
22921/22921 [==============================] - 231s 10ms/step - loss: 0.0404 - accuracy: 0.9500
Epoch 8/8
62500/62500 [==============================] - 2244s 36ms/step - loss: 0.0547 - accuracy: 0.9404 - val_loss: 0.0475 - val_accuracy: 0.9415 - lr: 4.4062e-05
22921/22921 [==============================] - 234s 10ms/step - loss: 0.0429 - accuracy: 0.9511
Epoch 9/9
62500/62500 [==============================] - 2240s 36ms/step - loss: 0.0433 - accuracy: 0.9432 - val_loss: 0.0465 - val_accuracy: 0.9412 - lr: 4.3143e-05
22921/22921 [==============================] - 233s 10ms/step - loss: 0.0413 - accuracy: 0.9493
Epoch 10/10
62500/62500 [==============================] - 2273s 36ms/step - loss: 0.0749 - accuracy: 0.9435 - val_loss: 0.0446 - val_accuracy: 0.9414 - lr: 4.2243e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0404 - accuracy: 0.9493

>>>> Stage: 2/3, target_shape: 224, dropout: 0.2, magnitude: 15, batch_size: 4
>>>> This stage runs from epoch 11 to 20 out of 50 total epochs
Epoch 11/11
62500/62500 [==============================] - 2236s 36ms/step - loss: 0.0503 - accuracy: 0.9282 - val_loss: 0.0536 - val_accuracy: 0.9274 - lr: 4.1362e-05
22921/22921 [==============================] - 230s 10ms/step - loss: 0.0411 - accuracy: 0.9475
Epoch 12/12
62500/62500 [==============================] - 2243s 36ms/step - loss: 0.0481 - accuracy: 0.9301 - val_loss: 0.0532 - val_accuracy: 0.9305 - lr: 4.0500e-05
22921/22921 [==============================] - 230s 10ms/step - loss: 0.0401 - accuracy: 0.9507
Epoch 13/13
62500/62500 [==============================] - 2237s 36ms/step - loss: 0.0475 - accuracy: 0.9337 - val_loss: 0.0471 - val_accuracy: 0.9398 - lr: 3.9656e-05
22921/22921 [==============================] - 230s 10ms/step - loss: 0.0379 - accuracy: 0.9551
Epoch 14/14
62500/62500 [==============================] - 2241s 36ms/step - loss: 0.0472 - accuracy: 0.9334 - val_loss: 0.0512 - val_accuracy: 0.9343 - lr: 3.8829e-05
22921/22921 [==============================] - 230s 10ms/step - loss: 0.0404 - accuracy: 0.9543
Epoch 15/15
62500/62500 [==============================] - 2245s 36ms/step - loss: 0.0460 - accuracy: 0.9346 - val_loss: 0.0492 - val_accuracy: 0.9348 - lr: 3.8019e-05
22921/22921 [==============================] - 232s 10ms/step - loss: 0.0372 - accuracy: 0.9534
New best-performing epoch of model (size = 224px) saved as: "C:\Users\smart\Desktop\mewc-output-dir"/mewc_model_224px_best.h5
Epoch 16/16
62500/62500 [==============================] - 2219s 36ms/step - loss: 0.0445 - accuracy: 0.9361 - val_loss: 0.0461 - val_accuracy: 0.9383 - lr: 3.7226e-05
22921/22921 [==============================] - 232s 10ms/step - loss: 0.0360 - accuracy: 0.9548
New best-performing epoch of model (size = 224px) saved as: "C:\Users\smart\Desktop\mewc-output-dir"/mewc_model_224px_best.h5
Epoch 17/17
62500/62500 [==============================] - 2216s 35ms/step - loss: 1.1650 - accuracy: 0.8642 - val_loss: 14.8950 - val_accuracy: 0.0260 - lr: 3.6450e-05
22921/22921 [==============================] - 232s 10ms/step - loss: 14.8941 - accuracy: 0.0260
Epoch 18/18
62500/62500 [==============================] - 2232s 36ms/step - loss: 12.7601 - accuracy: 0.1546 - val_loss: 14.8223 - val_accuracy: 0.0307 - lr: 3.5690e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 14.8365 - accuracy: 0.0298
Epoch 19/19
62500/62500 [==============================] - 2231s 36ms/step - loss: 6.8878 - accuracy: 0.5090 - val_loss: 0.0545 - val_accuracy: 0.9324 - lr: 3.4946e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0432 - accuracy: 0.9521
Epoch 20/20
62500/62500 [==============================] - 2234s 36ms/step - loss: 0.0464 - accuracy: 0.9344 - val_loss: 0.0503 - val_accuracy: 0.9368 - lr: 3.4217e-05
22921/22921 [==============================] - 230s 10ms/step - loss: 0.0403 - accuracy: 0.9524

>>>> Stage: 3/3, target_shape: 224, dropout: 0.3, magnitude: 25, batch_size: 4
>>>> This stage runs from epoch 21 to 50 out of 50 total epochs
Epoch 21/21
62500/62500 [==============================] - 2218s 35ms/step - loss: 0.0781 - accuracy: 0.8896 - val_loss: 0.0801 - val_accuracy: 0.8890 - lr: 3.3504e-05
22921/22921 [==============================] - 232s 10ms/step - loss: 0.0406 - accuracy: 0.9456
Epoch 22/22
62500/62500 [==============================] - 2225s 36ms/step - loss: 0.0729 - accuracy: 0.8953 - val_loss: 0.0647 - val_accuracy: 0.9118 - lr: 3.2805e-05
22921/22921 [==============================] - 233s 10ms/step - loss: 0.0376 - accuracy: 0.9540
Epoch 23/23
62500/62500 [==============================] - 2233s 36ms/step - loss: 0.0699 - accuracy: 0.9000 - val_loss: 0.0682 - val_accuracy: 0.9069 - lr: 3.2121e-05
22921/22921 [==============================] - 231s 10ms/step - loss: 0.0378 - accuracy: 0.9530
Epoch 24/24
62500/62500 [==============================] - 2226s 36ms/step - loss: 0.0689 - accuracy: 0.9014 - val_loss: 0.0653 - val_accuracy: 0.9110 - lr: 3.1451e-05
22921/22921 [==============================] - 230s 10ms/step - loss: 0.0397 - accuracy: 0.9515
Epoch 25/25
62500/62500 [==============================] - 2220s 36ms/step - loss: 0.0661 - accuracy: 0.9044 - val_loss: 0.0708 - val_accuracy: 0.9036 - lr: 3.0795e-05
22921/22921 [==============================] - 225s 10ms/step - loss: 0.0390 - accuracy: 0.9503
Epoch 26/26
62500/62500 [==============================] - 2234s 36ms/step - loss: 0.0656 - accuracy: 0.9058 - val_loss: 0.0652 - val_accuracy: 0.9138 - lr: 3.0153e-05
22921/22921 [==============================] - 230s 10ms/step - loss: 0.0380 - accuracy: 0.9548
Epoch 27/27
62500/62500 [==============================] - 2223s 36ms/step - loss: 0.0641 - accuracy: 0.9076 - val_loss: 0.0671 - val_accuracy: 0.9115 - lr: 2.9525e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0414 - accuracy: 0.9512
Epoch 28/28
62500/62500 [==============================] - 2222s 36ms/step - loss: 0.0632 - accuracy: 0.9088 - val_loss: 0.0681 - val_accuracy: 0.9129 - lr: 2.8909e-05
22921/22921 [==============================] - 225s 10ms/step - loss: 0.0398 - accuracy: 0.9550
Epoch 29/29
62500/62500 [==============================] - 2197s 35ms/step - loss: 0.0612 - accuracy: 0.9112 - val_loss: 0.0605 - val_accuracy: 0.9177 - lr: 2.8306e-05
22921/22921 [==============================] - 227s 10ms/step - loss: 0.0359 - accuracy: 0.9564
New best-performing epoch of model (size = 224px) saved as: "C:\Users\smart\Desktop\mewc-output-dir"/mewc_model_224px_best.h5
Epoch 30/30
62500/62500 [==============================] - 2226s 36ms/step - loss: 0.0606 - accuracy: 0.9126 - val_loss: 0.0615 - val_accuracy: 0.9194 - lr: 2.7716e-05
22921/22921 [==============================] - 229s 10ms/step - loss: 0.0373 - accuracy: 0.9563
Epoch 31/31
62500/62500 [==============================] - 2229s 36ms/step - loss: 0.0598 - accuracy: 0.9136 - val_loss: 0.0622 - val_accuracy: 0.9178 - lr: 2.7138e-05
22921/22921 [==============================] - 225s 10ms/step - loss: 0.0378 - accuracy: 0.9568
Epoch 32/32
62500/62500 [==============================] - 2233s 36ms/step - loss: 0.0598 - accuracy: 0.9142 - val_loss: 0.0604 - val_accuracy: 0.9213 - lr: 2.6572e-05
22921/22921 [==============================] - 227s 10ms/step - loss: 0.0370 - accuracy: 0.9576
Epoch 33/33
62500/62500 [==============================] - 2224s 36ms/step - loss: 0.0733 - accuracy: 0.9124 - val_loss: 0.0591 - val_accuracy: 0.9217 - lr: 2.6018e-05
22921/22921 [==============================] - 226s 10ms/step - loss: 0.0384 - accuracy: 0.9563
Epoch 34/34
62500/62500 [==============================] - 2228s 36ms/step - loss: 0.0604 - accuracy: 0.9157 - val_loss: 0.0589 - val_accuracy: 0.9195 - lr: 2.5475e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0365 - accuracy: 0.9549
Epoch 35/35
62500/62500 [==============================] - 2218s 35ms/step - loss: 0.0675 - accuracy: 0.9167 - val_loss: 0.0603 - val_accuracy: 0.9222 - lr: 2.4944e-05
22921/22921 [==============================] - 230s 10ms/step - loss: 0.0397 - accuracy: 0.9573
Epoch 36/36
62500/62500 [==============================] - 2229s 36ms/step - loss: 0.0653 - accuracy: 0.9161 - val_loss: 0.0642 - val_accuracy: 0.9169 - lr: 2.4424e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0404 - accuracy: 0.9542
Epoch 37/37
62500/62500 [==============================] - 2230s 36ms/step - loss: 0.0565 - accuracy: 0.9193 - val_loss: 0.0603 - val_accuracy: 0.9205 - lr: 2.3915e-05
22921/22921 [==============================] - 227s 10ms/step - loss: 0.0374 - accuracy: 0.9571
Epoch 38/38
62500/62500 [==============================] - 2226s 36ms/step - loss: 0.0565 - accuracy: 0.9189 - val_loss: 0.0527 - val_accuracy: 0.9281 - lr: 2.3416e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0321 - accuracy: 0.9613
New best-performing epoch of model (size = 224px) saved as: "C:\Users\smart\Desktop\mewc-output-dir"/mewc_model_224px_best.h5
Epoch 39/39
62500/62500 [==============================] - 2240s 36ms/step - loss: 0.0564 - accuracy: 0.9187 - val_loss: 0.0705 - val_accuracy: 0.9220 - lr: 2.2928e-05
22921/22921 [==============================] - 227s 10ms/step - loss: 0.0502 - accuracy: 0.9556
Epoch 40/40
62500/62500 [==============================] - 2239s 36ms/step - loss: 0.0562 - accuracy: 0.9200 - val_loss: 0.0629 - val_accuracy: 0.9211 - lr: 2.2450e-05
22921/22921 [==============================] - 226s 10ms/step - loss: 0.0394 - accuracy: 0.9577
Epoch 41/41
62500/62500 [==============================] - 2224s 36ms/step - loss: 0.0560 - accuracy: 0.9203 - val_loss: 0.0616 - val_accuracy: 0.9199 - lr: 2.1982e-05
22921/22921 [==============================] - 226s 10ms/step - loss: 0.0388 - accuracy: 0.9554
Epoch 42/42
62500/62500 [==============================] - 2242s 36ms/step - loss: 0.0579 - accuracy: 0.9206 - val_loss: 0.0614 - val_accuracy: 0.9174 - lr: 2.1523e-05
22921/22921 [==============================] - 227s 10ms/step - loss: 0.0397 - accuracy: 0.9531
Epoch 43/43
62500/62500 [==============================] - 2226s 36ms/step - loss: 0.0544 - accuracy: 0.9220 - val_loss: 0.0598 - val_accuracy: 0.9282 - lr: 2.1075e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0411 - accuracy: 0.9585
Epoch 44/44
62500/62500 [==============================] - 2237s 36ms/step - loss: 0.0555 - accuracy: 0.9208 - val_loss: 0.0579 - val_accuracy: 0.9272 - lr: 2.0635e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0369 - accuracy: 0.9590
Epoch 45/45
62500/62500 [==============================] - 2235s 36ms/step - loss: 0.0533 - accuracy: 0.9231 - val_loss: 0.0566 - val_accuracy: 0.9276 - lr: 2.0205e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0375 - accuracy: 0.9586
Epoch 46/46
62500/62500 [==============================] - 2227s 36ms/step - loss: 0.0534 - accuracy: 0.9232 - val_loss: 0.0553 - val_accuracy: 0.9282 - lr: 1.9784e-05
22921/22921 [==============================] - 227s 10ms/step - loss: 0.0343 - accuracy: 0.9594
Epoch 47/47
62500/62500 [==============================] - 2225s 36ms/step - loss: 0.0535 - accuracy: 0.9233 - val_loss: 0.0548 - val_accuracy: 0.9311 - lr: 1.9371e-05
22921/22921 [==============================] - 230s 10ms/step - loss: 0.0377 - accuracy: 0.9607
Epoch 48/48
62500/62500 [==============================] - 2241s 36ms/step - loss: 0.0554 - accuracy: 0.9232 - val_loss: 0.0625 - val_accuracy: 0.9190 - lr: 1.8967e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0381 - accuracy: 0.9562
Epoch 49/49
62500/62500 [==============================] - 2231s 36ms/step - loss: 0.0523 - accuracy: 0.9244 - val_loss: 0.0576 - val_accuracy: 0.9223 - lr: 1.8572e-05
22921/22921 [==============================] - 227s 10ms/step - loss: 0.0360 - accuracy: 0.9576
Epoch 50/50
62500/62500 [==============================] - 2232s 36ms/step - loss: 0.0533 - accuracy: 0.9239 - val_loss: 0.0554 - val_accuracy: 0.9291 - lr: 1.8184e-05
22921/22921 [==============================] - 228s 10ms/step - loss: 0.0367 - accuracy: 0.9604
Final model at epoch 50 of model (size = 224px) saved as: "C:\Users\smart\Desktop\mewc-output-dir"/mewc_model_224px_final
22921/22921 [==============================] - 226s 10ms/step - loss: 0.0367 - accuracy: 0.9604

Final Epoch: test loss, test acc: [0.036662954837083817, 0.9604184031486511]

(base) C:\Users\smart>


















docker exec vigilant_moore --env CUDA_VISIBLE_DEVICES=0 --gpus all --env-file "C:\Users\smart\Desktop\params.env" --volume "C:\Peter\training-utils\current-train-set":/data zaandahl/mewc-train

docker run --env CUDA_VISIBLE_DEVICES=0 --gpus all --env-file "C:\Users\smart\Desktop\params.env" --volume C:\Peter\training-utils\current-train-set:/data zaandahl/mewc-train


docker run --env CUDA_VISIBLE_DEVICES=0 --gpus all --env-file "C:\Users\smart\Desktop\params.env" --volume "C:\Peter\training-utils\current-train-set":/data PetervanLunteren/mewc-train

docker run --env CUDA_VISIBLE_DEVICES=0 --gpus all --env-file "%PARAMS%" --volume "%DATA_DIR%":/data zaandahl/mewc-train


docker exec competent_northcutt ls /
bin/bash python code\mewc.py


docker exec -it <container_id_or_name> chmod +x /path/to/your/python/file/example.py


set LOCAL_MEWC_TRAIN_DIR=C:\Users\smart\Desktop\mewc-output-dir

docker run --env CUDA_VISIBLE_DEVICES=0 --gpus all --env-file "%PARAMS%" --volume "%DATA_DIR%":/data --volume "%LOCAL_MEWC_TRAIN_DIR%":src zaandahl/mewc-train
